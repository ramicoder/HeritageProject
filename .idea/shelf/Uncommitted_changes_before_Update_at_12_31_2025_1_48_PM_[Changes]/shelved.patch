Index: src/main/java/com/ramiaran/heritagesitesystem/HeritageController.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.ramiaran.heritagesitesystem;\r\n\r\nimport javafx.fxml.FXML;\r\nimport javafx.scene.control.Label;\r\n\r\nimport java.time.LocalDate;\r\nimport java.util.LinkedList;\r\nimport java.util.Stack;\r\nimport java.util.Iterator;\r\nimport javafx.scene.control.Alert;\r\nimport javafx.scene.control.ButtonType;\r\nimport java.util.Optional;\r\n\r\npublic class HeritageController {\r\n\r\n    // The variables for our UI components  -Rami\r\n    // They link our Java code to the specific boxes on the screen.\r\n    // If the FXML file has fx:id=\"nameField\", this variable grabs it.\r\n    @FXML private javafx.scene.control.ComboBox<String> categoryBox; // The dropdown for categories\r\n    @FXML private javafx.scene.control.ComboBox<String> siteBox;     // The dropdown for specific sites\r\n    @FXML private javafx.scene.control.TextField nameField;          // Input box for visitor Name\r\n    @FXML private javafx.scene.control.TextField idField;            // Input box for visitor ID\r\n    @FXML private javafx.scene.control.TextField phoneField;         // Input box for phone number\r\n    @FXML private javafx.scene.control.DatePicker datePicker;        // The calendar popup\r\n    @FXML private javafx.scene.control.TextArea feedbackArea;        // The big text box at the bottom for messages/errors\r\n    @FXML private javafx.scene.control.TextField searchField;        // Input for search\r\n    @FXML private javafx.scene.control.CheckBox ascendingCheck;      // Checkbox for sorting\r\n    @FXML private javafx.scene.control.ComboBox<String> viewCategoryBox; // Filter dropdown for Option 4\r\n\r\n    // This is for the tableview holding value of the visit object we made\r\n    @FXML private javafx.scene.control.TableView<Visit> resultsTable;\r\n\r\n    // These columns tell the table which part of the Visit object to show.\r\n    @FXML private javafx.scene.control.TableColumn<Visit, String> colName;     // Shows visit.getVisitorName()\r\n    @FXML private javafx.scene.control.TableColumn<Visit, String> colSite;     // Shows visit.getSiteName()\r\n    @FXML private javafx.scene.control.TableColumn<Visit, String> colCategory; // Shows visit.getCategory()\r\n    @FXML private javafx.scene.control.TableColumn<Visit, String> colDate;     // Shows visit.getVisitDate()\r\n\r\n    // This method is created so that JavaFX runs it automatically when the screen opens.\r\n    // We use it to set up the starting state of the app.\r\n    @FXML\r\n    public void initialize() {\r\n        initializeSites(); // Calls our existing method to load the 12 heritage sites into memory.\r\n\r\n        // Add the 3 options to the Category Dropdown so the user can pick them.\r\n        categoryBox.getItems().addAll(\"Historical\", \"Museum\", \"Archaeological\");\r\n        viewCategoryBox.getItems().addAll(\"Historical\", \"Museum\", \"Archaeological\");\r\n\r\n        // This code is ran when a user picks a category\r\n        categoryBox.setOnAction(e -> {\r\n            String selected = categoryBox.getValue(); // Get what they picked\r\n            // If they picked something, find the matching sites and put them in the Site Dropdown.\r\n            if (selected != null) {\r\n                siteBox.getItems().setAll(getSiteNamesByCategory(selected));\r\n            }\r\n        });\r\n\r\n        // This connects the Table Columns to our Visit.java class.\r\n        // \"visitorName\" must match the variable name in our Visit class exactly!\r\n        colName.setCellValueFactory(new javafx.scene.control.cell.PropertyValueFactory<>(\"visitorName\"));\r\n        colSite.setCellValueFactory(new javafx.scene.control.cell.PropertyValueFactory<>(\"siteName\"));\r\n        colCategory.setCellValueFactory(new javafx.scene.control.cell.PropertyValueFactory<>(\"category\"));\r\n        colDate.setCellValueFactory(new javafx.scene.control.cell.PropertyValueFactory<>(\"visitDate\"));\r\n\r\n        // Allow user to click a row in the \"All Visits\" Table to auto-fill the cancel visit fields\r\n        resultsTable.setRowFactory(tv -> {\r\n            javafx.scene.control.TableRow<Visit> row = new javafx.scene.control.TableRow<>();\r\n            row.setOnMouseClicked(event -> {\r\n                if (!row.isEmpty() && event.getClickCount() == 1) { // Single click on a non-empty row\r\n                    Visit clickedVisit = row.getItem();\r\n\r\n                    // Auto-fill the cancel visit fields\r\n                    categoryBox.setValue(clickedVisit.getCategory());\r\n                    siteBox.setItems(javafx.collections.FXCollections.observableArrayList(\r\n                            getSiteNamesByCategory(clickedVisit.getCategory())\r\n                    ));\r\n                    siteBox.setValue(clickedVisit.getSiteName());\r\n                    idField.setText(clickedVisit.getVisitorId());\r\n                }\r\n            });\r\n            return row;\r\n        });\r\n    }\r\n\r\n    private LinkedList<Visit> allVisits = new LinkedList<>();\r\n    private Stack<Visit> recentBookings = new Stack<>();\r\n    private LinkedList<HeritageSite> allSites = new LinkedList<>();\r\n\r\n    // Initialize the 12 required sites\r\n    public void initializeSites() {\r\n        // Historical\r\n        allSites.add(new HeritageSite(\"Erbil Citadel\", \"Erbil\", \"6000 BC\", \"Historical\", \"Ancient citadel\"));\r\n        allSites.add(new HeritageSite(\"Qaysari Bazaar\", \"Erbil\", \"13th Century\", \"Historical\", \"Market\"));\r\n        allSites.add(new HeritageSite(\"Minare Park\", \"Erbil\", \"12th Century\", \"Historical\", \"Tower\"));\r\n        allSites.add(new HeritageSite(\"Khanzad Castle\", \"Erbil\", \"16th Century\", \"Historical\", \"Fort\"));\r\n\r\n        // Museums\r\n        allSites.add(new HeritageSite(\"Erbil Museum\", \"Erbil\", \"1989\", \"Museum\", \"Civilization\"));\r\n        allSites.add(new HeritageSite(\"Textile Museum\", \"Erbil\", \"2004\", \"Museum\", \"Carpets\"));\r\n        allSites.add(new HeritageSite(\"Slemani Museum\", \"Sulaymaniyah\", \"1961\", \"Museum\", \"Artifacts\"));\r\n        allSites.add(new HeritageSite(\"Gem Museum\", \"Erbil\", \"2010\", \"Museum\", \"Stones\"));\r\n\r\n        // Archaeological\r\n        allSites.add(new HeritageSite(\"Shanidar Cave\", \"Bradost\", \"65000 BC\", \"Archaeological\", \"Neanderthals\"));\r\n        allSites.add(new HeritageSite(\"Jarmo\", \"Zagros\", \"7000 BC\", \"Archaeological\", \"Farming\"));\r\n        allSites.add(new HeritageSite(\"Barda Balka\", \"Chemchemal\", \"Paleolithic\", \"Archaeological\", \"Tools\"));\r\n        allSites.add(new HeritageSite(\"Halamata Cave\", \"Duhok\", \"Assyrian\", \"Archaeological\", \"Reliefs\"));\r\n    }\r\n    // Option 1 Rami- Aran\r\n    public String[] getCategories() {\r\n        return new String[]{\"Historical Sites\", \"Museums\", \"Archaeological Sites\"}; // This is displaying the heritage site categories and the input is taken in the UI\r\n    }\r\n\r\n    // Option 2: Schedule a Visit - rami aran\r\n    public String scheduleVisit(String category, String siteName, String name, String id, String phone, java.time.LocalDate date) {\r\n        // validation check, making sure no empty input is done\r\n        if (category == null || siteName == null || name.isBlank() || id.isBlank() || phone.isBlank() || date == null) {\r\n            return \"Error: All fields are required.\";\r\n        }\r\n        // validate that date is not in the past\r\n        if (date.isBefore(java.time.LocalDate.now())) {\r\n            return \"Error: You cannot book a visit in the past.\";\r\n        }\r\n        //we will use Regex to validate the input text\r\n        if (!name.matches(\"[a-zA-Z\\\\s]+\")) {\r\n            return \"Error: Name must contain letters and spaces only.\";\r\n        }\r\n\r\n        if (!phone.matches(\"07\\\\d{9}\")) {\r\n            return \"Error: Phone number must be exactly 11 digits and an Iraqi number.\";\r\n        }\r\n        // 4. Check ID (Numeric only)\r\n        if (!id.matches(\"\\\\d+\")) {\r\n            return \"Error: ID must be numeric.\";\r\n        }\r\n        name = name.trim();\r\n        id = id.trim();\r\n        phone = phone.trim();\r\n        // VALIDATION: Check for ID Conflict\r\n        for (Visit v : allVisits) {\r\n            if (v.getVisitorId().equalsIgnoreCase(id)) {\r\n                // We found the ID. Now ensure the name matches the original owner.\r\n                if (!v.getVisitorName().equalsIgnoreCase(name)) {\r\n                    return \"Error: ID \" + id + \" is already registered to \" + v.getVisitorName() + \".\";\r\n                }\r\n            }\r\n        }\r\n        StringBuilder bob = new StringBuilder();\r\n\r\n        //preventing duplicate visits\r\n        for (Visit v : allVisits) {\r\n            if (\r\n                    v.getCategory().equalsIgnoreCase(category) &&\r\n                            v.getSiteName().equalsIgnoreCase(siteName) &&\r\n                            v.getVisitorId().equalsIgnoreCase(id) &&\r\n                            v.getVisitDate().equals(date)\r\n            ) {\r\n                return \"Error: This visit is already scheduled for this date.\";\r\n            }\r\n        }\r\n\r\n        // 1. counting how many times the visitor visited based on the id\r\n        int count = 0;\r\n        for (Visit v : allVisits) {\r\n            if (v.getVisitorId().equalsIgnoreCase(id)) {\r\n                count++;\r\n            }\r\n        }\r\n\r\n        // 2. if visitor count reached 2 or more, generate verification code\r\n        if (count >= 2) {\r\n            int code = 100000 + new java.util.Random().nextInt(900000);\r\n            bob.append(\"You are qualified for a free guided tour! The following code is your reference\\n\");\r\n            bob.append(\"Confirmation Code sent to \").append(phone).append(\": \").append(code).append(\"\\n\");\r\n        }\r\n\r\n        // 3. Create the Visit object\r\n        Visit newVisit = new Visit(category, siteName, name, id, phone, date);\r\n\r\n        // 4. Adding the new visit to the bookings stack and all visits linked list\r\n        allVisits.add(newVisit);\r\n        recentBookings.push(newVisit);\r\n\r\n        // 5. Final Success Message\r\n        bob.append(\"Scheduled: \").append(name).append(\" to \").append(siteName);\r\n\r\n        // Return String for UI\r\n        return bob.toString();\r\n    }\r\n\r\n    // Option 2 Helper: Used by the UI to filter sites in the Dropdown\r\n    public java.util.List<String> getSiteNamesByCategory(String category) {\r\n        java.util.List<String> names = new java.util.ArrayList<>();\r\n\r\n        // Loop through all sites\r\n        for (HeritageSite site : allSites) {\r\n            // if the site matches the category (e.g., \"Museum\"), add its name to the list\r\n            if (site.getCategory().equalsIgnoreCase(category)) {\r\n                names.add(site.getName());\r\n            }\r\n        }\r\n        return names; // give the needed list back to the UI\r\n    }\r\n\r\n    //option 3 is to cancel a visit based on a category, site name, and visitor id- Aran\r\n    public boolean cancelVisit(String category, String siteName, String visitorId){\r\n        if (category == null || siteName == null || visitorId == null)\r\n            return false;\r\n        if (category.isBlank() || siteName.isBlank() || visitorId.isBlank())\r\n            return false; //line 67-68 are just validators in order to make sure there is something to delete\r\n        Iterator<Visit> pointer = allVisits.iterator();\r\n        visitorId = visitorId.trim();\r\n        siteName = siteName.trim();\r\n        category = category.trim();\r\n        while (pointer.hasNext()){\r\n            Visit v = pointer.next(); // v is the current visit it is pointing at\r\n            // hasNext() checks if theres an element after the current one\r\n            // Next moves the pointer to the next element\r\n            // the following loop is to compare using the getters in \"Visit\" to make sure we are deleting the correct visit, and it gives the metehod a return value\r\n            if (\r\n                    v.getCategory().equalsIgnoreCase(category) &&\r\n                            v.getSiteName().equalsIgnoreCase(siteName) &&\r\n                            v.getVisitorId().equalsIgnoreCase(visitorId)\r\n            ){\r\n                pointer.remove();//Safe Deletion, not masking.\r\n                recentBookings.remove(v);\r\n                return true;\r\n            }\r\n\r\n        }\r\n        return false;\r\n    }\r\n\r\n    // Option 4: View Visits (Return list for UI) -Rami\r\n    public LinkedList<Visit> viewVisits(String category, boolean ascending) {\r\n\r\n        // 1. Filter: specific category only\r\n        // We use a temporary list so we don't mess up the main 'allVisits' list\r\n        LinkedList<Visit> filteredList = new LinkedList<>();\r\n        for (Visit v : allVisits) {\r\n            // using a linear search to traverse through our linked list and add it to our new list if matching the category\r\n            if (v.getCategory().equalsIgnoreCase(category)) {\r\n                filteredList.add(v);\r\n            }\r\n        }\r\n\r\n        // 2. Sort: Explicit Comparator\r\n        //soring with timsort(a combination of merge and insertion sort with a big O of Nlog(N))\r\n        //the lamba expression is its syntax which sorts based on the compareto values when comparing the dates\r\n        filteredList.sort((v1, v2) -> {\r\n            if (ascending) return v1.getVisitDate().compareTo(v2.getVisitDate());\r\n            else return v2.getVisitDate().compareTo(v1.getVisitDate());\r\n        });\r\n        // Return the list to the UI\r\n        return filteredList;\r\n    }\r\n\r\n    // Option 5: Display Totals (Return String for UI)- Rami\r\n    public String displayTotals() {\r\n        if (allVisits.isEmpty()) {\r\n            return \"--- System Totals ---\\nNo visits recorded yet.\";\r\n        }\r\n        StringBuilder bob = new StringBuilder();\r\n        bob.append(\"--- System Totals ---\\n\");\r\n\r\n        // 1. Get unique categories\r\n        LinkedList<String> categories = new LinkedList<>(); // We did an Array initially, but AI recommended that we use a linked list for cleanliness and efficiency.\r\n        for (HeritageSite site : allSites) { //we traverse through all sites and get the unique categories instead of having redundancy\r\n            boolean exists = false;\r\n            for(String c : categories) {\r\n                if(c.equalsIgnoreCase(site.getCategory())){\r\n                    exists = true;\r\n                    break; //once we get the category we break because we don't need to go through the other categories after we found one matching\r\n                }\r\n            }\r\n            if (!exists) categories.add(site.getCategory());\r\n        }\r\n\r\n        // 2. Loop through Categories\r\n        for (String cat : categories) {\r\n            // Count total visits for this category\r\n            int catCount = 0;\r\n            for (Visit v : allVisits) {\r\n                if (v.getCategory().equalsIgnoreCase(cat)) {\r\n                    catCount++;\r\n                }\r\n            }\r\n            bob.append(cat).append(\": \").append(catCount).append(\" total visits\\n\");\r\n\r\n            // 3. same logic as for category but for sites now\r\n            for (HeritageSite site : allSites) {\r\n                if (site.getCategory().equalsIgnoreCase(cat)) {\r\n                    int siteCount = 0;\r\n                    for (Visit v : allVisits) {\r\n                        if (v.getSiteName().equalsIgnoreCase(site.getName())) {\r\n                            siteCount++;\r\n                        }\r\n                    }\r\n                    bob.append(\"   - \").append(site.getName().trim()).append(\": \").append(siteCount).append(\"\\n\");\r\n                }\r\n            }\r\n        }\r\n        return bob.toString();\r\n    }\r\n\r\n    //Option 6, searching for a visitor - Aran\r\n    /*\r\n      The method creates a new linked lists which acts like a basket in order to display the\r\n      results of the search to the user.\r\n    */\r\n    public LinkedList<Visit> searchVisitor(String visitorId, String visitorName){\r\n\r\n        /* the following is to create the new temporary linked list\r\n           it is also worthy to note that a visitor can have several visits, that is why an ordinary string is not\r\n           being made but instead a linked list\r\n        */\r\n        LinkedList<Visit> SearchResult = new LinkedList<>();\r\n\r\n        boolean hasId = visitorId != null && !visitorId.isBlank();\r\n        //This is to check if the user provided valid ID to search for\r\n\r\n        boolean hasName = visitorName != null && !visitorName.isBlank();\r\n        // this is to checl if the user provided a valid Name that is stored\r\n\r\n        if (!hasId && !hasName){\r\n            return SearchResult;\r\n        }\r\n\r\n    /* The following portion is to prioritize ID search over Name seaarch, although it will still search for the\r\n       name, the Id is prioritized over it\r\n    */\r\n        if (hasId) {\r\n\r\n            visitorId = visitorId.trim().toLowerCase();\r\n\r\n            for (Visit v : allVisits) { // traverses the visits\r\n                if (v.getVisitorId().toLowerCase().equals(visitorId)){\r\n                    SearchResult.add(v);\r\n\r\n                /* this is a conditonal loop, not a nested loop, before I wrote one big loop, but it was messy\r\n                   and hard to understand so AI helped me make it more clean and easier to understand\r\n                */\r\n                }\r\n            }\r\n\r\n        }\r\n        if (hasName) {\r\n\r\n            for (Visit v : allVisits) {\r\n                if (v.getVisitorName().toLowerCase().equals(visitorName.trim().toLowerCase())) {\r\n                    SearchResult.add(v);\r\n                }\r\n            }\r\n\r\n        }\r\n        return SearchResult;\r\n    }\r\n\r\n    // Option 7: Get the most recently scheduled visits - Aran\r\n    /*\r\n       This method returns the latest bookings (up to 10) in newest-to-oldest order.\r\n       It returns a LinkedList so the UI can display the results (e.g., in a TableView)\r\n       instead of printing directly to the console.\r\n    */\r\n    public LinkedList<Visit> getRecentVisits() {\r\n\r\n        // This LinkedList acts as a basket to store the recent visits for the UI\r\n        LinkedList<Visit> result = new LinkedList<>();\r\n\r\n        // Validate that there are recent bookings stored in the stack\r\n        if (recentBookings.isEmpty()) {\r\n            return result; // return empty list if there are no bookings\r\n        }\r\n\r\n        // Limit ensures we do not exceed 10 visits or the stack size\r\n        int limit = Math.min(10, recentBookings.size());\r\n\r\n    /*\r\n       The stack stores visits in LIFO order (Last In, First Out).\r\n       - The most recent visit is at index size - 1\r\n       - We loop backwards to display the newest visits first\r\n       - The loop stops once we reach the defined limit\r\n    */\r\n        for (int i = recentBookings.size() - 1; i >= recentBookings.size() - limit; i--) {\r\n\r\n            Visit v = recentBookings.get(i);\r\n\r\n        /*\r\n           A new Visit object is created with trimmed values to ensure\r\n           clean and consistent data is displayed in the UI.\r\n           The original Visit objects stored in memory are not modified.\r\n        */\r\n            Visit cleanVisit = new Visit(\r\n                    v.getCategory().trim(),\r\n                    v.getSiteName().trim(),\r\n                    v.getVisitorName().trim(),\r\n                    v.getVisitorId().trim(),\r\n                    v.getPhoneNumber().trim(),\r\n                    v.getVisitDate()\r\n            );\r\n\r\n            result.add(cleanVisit);\r\n        }\r\n\r\n        // Return the list of recent visits to be displayed by the UI\r\n        return result;\r\n    }\r\n\r\n    // Option 8: Summary Report (Return String for UI) -Rami\r\n    public String generateSummaryReport() {\r\n\r\n        if (allVisits.isEmpty()) {\r\n            return \"--- Summary Report ---\\nNo visits recorded yet.\";\r\n        }\r\n\r\n        StringBuilder bob = new StringBuilder();\r\n        bob.append(\"--- Summary Report ---\\n\");\r\n\r\n        // --- Find Top Category ---\r\n        int maxCatCount = -1;\r\n        LinkedList<String> topCategories = new LinkedList<>();\r\n\r\n\r\n        // Get unique categories manually using a new linked list\r\n        // also no worries if matches same name as another linked list because this is declared locally so the scoping took care of that\r\n        LinkedList<String> categories = new LinkedList<>();\r\n        //we use a nested loop to only get the unique categories within all our sites like what we did in option 5\r\n        for (HeritageSite s : allSites) {\r\n            boolean present = false;\r\n            for (String c : categories) {\r\n                if (c.equalsIgnoreCase(s.getCategory())) {\r\n                    present = true;\r\n                    break;\r\n                }\r\n            }\r\n            if (!present) {\r\n                categories.add(s.getCategory());\r\n            }\r\n        }\r\n\r\n        // Count visits per category\r\n        for (String cat : categories) {\r\n            int count = 0;\r\n            for (Visit v : allVisits) {\r\n                if (v.getCategory().equalsIgnoreCase(cat)) {\r\n                    count++;\r\n                }\r\n            }\r\n            // we find the name for the category with most visits and its visit count\r\n            if (count > maxCatCount) {\r\n                maxCatCount = count;\r\n                topCategories.clear();\r\n                topCategories.add(cat);\r\n            } else if (count == maxCatCount) {\r\n                topCategories.add(cat);\r\n            }\r\n        }\r\n\r\n        bob.append(\"Top Category: \")\r\n                .append(String.join(\", \", topCategories))\r\n                .append(\" (\")\r\n                .append(maxCatCount)\r\n                .append(\" visits)\\n\");\r\n\r\n        // same logic as above but with site\r\n        int maxSiteCount = -1;\r\n        LinkedList<String> topSites = new LinkedList<>();\r\n\r\n        for (HeritageSite site : allSites) {\r\n            int count = 0;\r\n            for (Visit v : allVisits) {\r\n                if (v.getSiteName().equalsIgnoreCase(site.getName())) {\r\n                    count++;\r\n                }\r\n            }\r\n\r\n            if (count > maxSiteCount) {\r\n                maxSiteCount = count;\r\n                topSites.clear();\r\n                topSites.add(site.getName());\r\n            } else if (count == maxSiteCount) {\r\n                topSites.add(site.getName());\r\n            }\r\n        }\r\n\r\n        bob.append(\"Top Site:     \")\r\n                .append(String.join(\", \", topSites))\r\n                .append(\" (\")\r\n                .append(maxSiteCount)\r\n                .append(\" visits)\\n\");\r\n\r\n        return bob.toString();\r\n    }\r\n\r\n    private void clearInputs() {\r\n        nameField.clear();\r\n        idField.clear();\r\n        phoneField.clear();\r\n        datePicker.setValue(null);\r\n        categoryBox.getSelectionModel().clearSelection();\r\n        siteBox.getItems().clear(); // Clears the dependent dropdown too\r\n    }\r\n\r\n    // These methods run when you click the buttons in the GUI.\r\n\r\n    @FXML\r\n    void onScheduleClick() {\r\n        // 1. Call the existing logic method\r\n        String result = scheduleVisit(\r\n                categoryBox.getValue(),\r\n                siteBox.getValue(),\r\n                nameField.getText(),\r\n                idField.getText(),\r\n                phoneField.getText(),\r\n                datePicker.getValue()\r\n        );\r\n        // 2. Show the result in the big text area\r\n        feedbackArea.setText(result);\r\n        if (!result.startsWith(\"Error\")) {\r\n            clearInputs();\r\n        }\r\n    }\r\n\r\n    @FXML\r\n    void onCancelClick() {\r\n\r\n        if (categoryBox.getValue() == null || siteBox.getValue() == null || idField.getText().isBlank()) {\r\n            feedbackArea.setText(\"Error: Please select a category, site, and enter visitor ID.\");\r\n            clearInputs();\r\n            return; // stop further execution because of empty values\r\n        }\r\n\r\n        Alert confirm = new Alert(Alert.AlertType.CONFIRMATION);\r\n        confirm.setTitle(\"Confirm Cancellation\");\r\n        confirm.setHeaderText(null);\r\n        confirm.setContentText(\"Are you sure you want to cancel this visit?\");\r\n\r\n        Optional<ButtonType> result = confirm.showAndWait();\r\n        if (result.isEmpty() || result.get() != ButtonType.OK) {\r\n            feedbackArea.setText(\"Cancellation aborted.\");\r\n            return; // user pressed Cancel or closed the dialog\r\n        }\r\n\r\n        boolean success = cancelVisit(categoryBox.getValue(), siteBox.getValue(), idField.getText());\r\n\r\n        if (success) {\r\n            feedbackArea.setText(\"Success: Visit for visitor \" + idField.getText() + \" has been cancelled.\");\r\n        } else {\r\n            feedbackArea.setText(\"Error: Could not cancel. Check Category, Site, and ID.\");\r\n        }\r\n        clearInputs();\r\n    }\r\n\r\n    @FXML\r\n    void onExitClick() {\r\n        // This is real logic: It shuts down the Java program.\r\n        System.exit(0);\r\n    }\r\n\r\n    @FXML\r\n    void onSearchClick() {\r\n        // 1. Get the list from your logic\r\n        java.util.LinkedList<Visit> found = searchVisitor(searchField.getText(), searchField.getText());\r\n\r\n        // 2. Clear table and add new data\r\n        resultsTable.getItems().clear();\r\n        resultsTable.getItems().addAll(found);\r\n\r\n        // 3. User feedback\r\n        if(found.isEmpty()) feedbackArea.setText(\"Search: No visitors found.\");\r\n        else feedbackArea.setText(\"Search: Found \" + found.size() + \" records.\");\r\n\r\n        // 4. Clear input field\r\n        searchField.clear();\r\n    }\r\n\r\n    @FXML\r\n    void onViewVisitsClick() {\r\n        String cat = viewCategoryBox.getValue();\r\n        if (cat == null) {\r\n            feedbackArea.setText(\"Error: Please select a Category to filter.\");\r\n            return;\r\n        }\r\n\r\n        // 1. Call your logic method (It handles sorting & filtering now)\r\n        LinkedList<Visit> data = viewVisits(cat, ascendingCheck.isSelected());\r\n        if (data.isEmpty()) {\r\n            feedbackArea.setText(\"No visits found for this category.\");\r\n        } else {\r\n        // 2. Give the list to the Table\r\n        resultsTable.getItems().setAll(data);\r\n        feedbackArea.setText(\"Showing \" + data.size() + \" visits for \" + cat);\r\n        }\r\n    }\r\n\r\n    @FXML\r\n    void onRecentClick() {\r\n        // 1. Get the list from your existing method\r\n        java.util.LinkedList<Visit> recent = getRecentVisits();\r\n\r\n        // 2. Update Table\r\n        resultsTable.getItems().setAll(recent);\r\n        // 3. Update feedback area\r\n        if (recent.isEmpty()) {\r\n            feedbackArea.setText(\"No recent bookings yet.\");\r\n        } else {\r\n            feedbackArea.setText(\"Showing \" + recent.size() + \" most recent bookings.\");\r\n        }\r\n    }\r\n\r\n    @FXML\r\n    void onTotalsClick() {\r\n        String report = displayTotals();\r\n        feedbackArea.setText(report);\r\n    }\r\n\r\n    @FXML\r\n    void onSummaryClick() {\r\n        String report = generateSummaryReport();\r\n        feedbackArea.setText(report);\r\n    }\r\n\r\n}\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/src/main/java/com/ramiaran/heritagesitesystem/HeritageController.java b/src/main/java/com/ramiaran/heritagesitesystem/HeritageController.java
--- a/src/main/java/com/ramiaran/heritagesitesystem/HeritageController.java	(revision 5aab72ecb702ba30513e14379fb1afc33e857df2)
+++ b/src/main/java/com/ramiaran/heritagesitesystem/HeritageController.java	(date 1767178107986)
@@ -619,5 +619,4 @@
         String report = generateSummaryReport();
         feedbackArea.setText(report);
     }
-
-}
+}
\ No newline at end of file
Index: .idea/workspace.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><?xml version=\"1.0\" encoding=\"UTF-8\"?>\r\n<project version=\"4\">\r\n  <component name=\"AutoImportSettings\">\r\n    <option name=\"autoReloadType\" value=\"SELECTIVE\" />\r\n  </component>\r\n  <component name=\"ChangeListManager\">\r\n    <list default=\"true\" id=\"34cabb51-2552-485f-ab94-eb3b3e64f8d7\" name=\"Changes\" comment=\"\">\r\n      <change beforePath=\"$PROJECT_DIR$/.idea/workspace.xml\" beforeDir=\"false\" afterPath=\"$PROJECT_DIR$/.idea/workspace.xml\" afterDir=\"false\" />\r\n      <change beforePath=\"$PROJECT_DIR$/src/main/java/com/ramiaran/heritagesitesystem/HeritageController.java\" beforeDir=\"false\" afterPath=\"$PROJECT_DIR$/src/main/java/com/ramiaran/heritagesitesystem/HeritageController.java\" afterDir=\"false\" />\r\n      <change beforePath=\"$PROJECT_DIR$/src/main/resources/com/ramiaran/heritagesitesystem/main-view.fxml\" beforeDir=\"false\" afterPath=\"$PROJECT_DIR$/src/main/resources/com/ramiaran/heritagesitesystem/main-view.fxml\" afterDir=\"false\" />\r\n    </list>\r\n    <option name=\"SHOW_DIALOG\" value=\"false\" />\r\n    <option name=\"HIGHLIGHT_CONFLICTS\" value=\"true\" />\r\n    <option name=\"HIGHLIGHT_NON_ACTIVE_CHANGELIST\" value=\"false\" />\r\n    <option name=\"LAST_RESOLUTION\" value=\"IGNORE\" />\r\n  </component>\r\n  <component name=\"FileTemplateManagerImpl\">\r\n    <option name=\"RECENT_TEMPLATES\">\r\n      <list>\r\n        <option value=\"Class\" />\r\n      </list>\r\n    </option>\r\n  </component>\r\n  <component name=\"Git.Settings\">\r\n    <option name=\"RECENT_GIT_ROOT_PATH\" value=\"$PROJECT_DIR$\" />\r\n  </component>\r\n  <component name=\"GitHubPullRequestSearchHistory\">{\r\n  &quot;lastFilter&quot;: {\r\n    &quot;state&quot;: &quot;OPEN&quot;,\r\n    &quot;assignee&quot;: &quot;AranRKh&quot;\r\n  }\r\n}</component>\r\n  <component name=\"GithubPullRequestsUISettings\">{\r\n  &quot;selectedUrlAndAccountId&quot;: {\r\n    &quot;url&quot;: &quot;https://github.com/ramicoder/HeritageProject.git&quot;,\r\n    &quot;accountId&quot;: &quot;208d1637-bdad-4562-8f28-ed34480fd157&quot;\r\n  }\r\n}</component>\r\n  <component name=\"MavenImportPreferences\">\r\n    <option name=\"generalSettings\">\r\n      <MavenGeneralSettings>\r\n        <option name=\"mavenHomeTypeForPersistence\" value=\"WRAPPER\" />\r\n      </MavenGeneralSettings>\r\n    </option>\r\n  </component>\r\n  <component name=\"ProjectColorInfo\">{\r\n  &quot;associatedIndex&quot;: 1\r\n}</component>\r\n  <component name=\"ProjectId\" id=\"37FYfubmAuw5IKuKiAcHRlEh9jq\" />\r\n  <component name=\"ProjectViewState\">\r\n    <option name=\"hideEmptyMiddlePackages\" value=\"true\" />\r\n    <option name=\"showLibraryContents\" value=\"true\" />\r\n  </component>\r\n  <component name=\"PropertiesComponent\">{\r\n  &quot;keyToString&quot;: {\r\n    &quot;Application.HelloApplication.executor&quot;: &quot;Run&quot;,\r\n    &quot;Application.HeritageApp.executor&quot;: &quot;Run&quot;,\r\n    &quot;ModuleVcsDetector.initialDetectionPerformed&quot;: &quot;true&quot;,\r\n    &quot;RunOnceActivity.ShowReadmeOnStart&quot;: &quot;true&quot;,\r\n    &quot;RunOnceActivity.TerminalTabsStorage.copyFrom.TerminalArrangementManager&quot;: &quot;true&quot;,\r\n    &quot;RunOnceActivity.TerminalTabsStorage.copyFrom.TerminalArrangementManager.252&quot;: &quot;true&quot;,\r\n    &quot;RunOnceActivity.git.unshallow&quot;: &quot;true&quot;,\r\n    &quot;RunOnceActivity.typescript.service.memoryLimit.init&quot;: &quot;true&quot;,\r\n    &quot;git-widget-placeholder&quot;: &quot;main&quot;,\r\n    &quot;kotlin-language-version-configured&quot;: &quot;true&quot;,\r\n    &quot;node.js.detected.package.eslint&quot;: &quot;true&quot;,\r\n    &quot;node.js.detected.package.tslint&quot;: &quot;true&quot;,\r\n    &quot;node.js.selected.package.eslint&quot;: &quot;(autodetect)&quot;,\r\n    &quot;node.js.selected.package.tslint&quot;: &quot;(autodetect)&quot;,\r\n    &quot;nodejs_package_manager_path&quot;: &quot;npm&quot;,\r\n    &quot;project.structure.last.edited&quot;: &quot;Project&quot;,\r\n    &quot;project.structure.proportion&quot;: &quot;0.0&quot;,\r\n    &quot;project.structure.side.proportion&quot;: &quot;0.0&quot;,\r\n    &quot;settings.editor.selected.configurable&quot;: &quot;terminal&quot;,\r\n    &quot;vue.rearranger.settings.migration&quot;: &quot;true&quot;\r\n  }\r\n}</component>\r\n  <component name=\"RunManager\">\r\n    <configuration name=\"HeritageApp\" type=\"Application\" factoryName=\"Application\" temporary=\"true\" nameIsGenerated=\"true\">\r\n      <option name=\"MAIN_CLASS_NAME\" value=\"com.ramiaran.heritagesitesystem.HeritageApp\" />\r\n      <module name=\"heritage-site-system\" />\r\n      <extension name=\"coverage\">\r\n        <pattern>\r\n          <option name=\"PATTERN\" value=\"com.ramiaran.heritagesitesystem.*\" />\r\n          <option name=\"ENABLED\" value=\"true\" />\r\n        </pattern>\r\n      </extension>\r\n      <method v=\"2\">\r\n        <option name=\"Make\" enabled=\"true\" />\r\n      </method>\r\n    </configuration>\r\n    <configuration default=\"true\" type=\"JetRunConfigurationType\">\r\n      <module name=\"HeritageProject\" />\r\n      <method v=\"2\">\r\n        <option name=\"Make\" enabled=\"true\" />\r\n      </method>\r\n    </configuration>\r\n    <configuration default=\"true\" type=\"KotlinStandaloneScriptRunConfigurationType\">\r\n      <module name=\"HeritageProject\" />\r\n      <option name=\"filePath\" />\r\n      <method v=\"2\" />\r\n    </configuration>\r\n    <recent_temporary>\r\n      <list>\r\n        <item itemvalue=\"Application.HeritageApp\" />\r\n      </list>\r\n    </recent_temporary>\r\n  </component>\r\n  <component name=\"SharedIndexes\">\r\n    <attachedChunks>\r\n      <set>\r\n        <option value=\"bundled-jdk-9823dce3aa75-fbdcb00ec9e3-intellij.indexing.shared.core-IU-251.26094.121\" />\r\n        <option value=\"bundled-js-predefined-d6986cc7102b-b26f3e71634d-JavaScript-IU-251.26094.121\" />\r\n      </set>\r\n    </attachedChunks>\r\n  </component>\r\n  <component name=\"TaskManager\">\r\n    <task active=\"true\" id=\"Default\" summary=\"Default task\">\r\n      <changelist id=\"34cabb51-2552-485f-ab94-eb3b3e64f8d7\" name=\"Changes\" comment=\"\" />\r\n      <created>1766500393512</created>\r\n      <option name=\"number\" value=\"Default\" />\r\n      <option name=\"presentableId\" value=\"Default\" />\r\n      <updated>1766500393512</updated>\r\n      <workItem from=\"1766500394601\" duration=\"7652000\" />\r\n      <workItem from=\"1766672840388\" duration=\"4608000\" />\r\n      <workItem from=\"1766686094793\" duration=\"495000\" />\r\n      <workItem from=\"1766846252876\" duration=\"1428000\" />\r\n      <workItem from=\"1766847819266\" duration=\"10451000\" />\r\n      <workItem from=\"1766860178176\" duration=\"36000\" />\r\n      <workItem from=\"1766860544492\" duration=\"11000\" />\r\n      <workItem from=\"1766866714580\" duration=\"5508000\" />\r\n      <workItem from=\"1766911376854\" duration=\"30625000\" />\r\n    </task>\r\n    <servers />\r\n  </component>\r\n  <component name=\"TypeScriptGeneratedFilesManager\">\r\n    <option name=\"version\" value=\"3\" />\r\n  </component>\r\n  <component name=\"Vcs.Log.Tabs.Properties\">\r\n    <option name=\"TAB_STATES\">\r\n      <map>\r\n        <entry key=\"MAIN\">\r\n          <value>\r\n            <State />\r\n          </value>\r\n        </entry>\r\n      </map>\r\n    </option>\r\n  </component>\r\n  <component name=\"XDebuggerManager\">\r\n    <breakpoint-manager>\r\n      <breakpoints>\r\n        <line-breakpoint enabled=\"true\" type=\"java-line\">\r\n          <url>file://$PROJECT_DIR$/src/main/java/com/ramiaran/heritagesitesystem/HeritageController.java</url>\r\n          <line>235</line>\r\n          <option name=\"timeStamp\" value=\"6\" />\r\n        </line-breakpoint>\r\n        <line-breakpoint enabled=\"true\" type=\"java-line\">\r\n          <url>file://$PROJECT_DIR$/src/main/java/com/ramiaran/heritagesitesystem/HeritageController.java</url>\r\n          <line>604</line>\r\n          <option name=\"timeStamp\" value=\"10\" />\r\n        </line-breakpoint>\r\n        <line-breakpoint enabled=\"true\" type=\"java-method\">\r\n          <url>file://$PROJECT_DIR$/src/main/java/com/ramiaran/heritagesitesystem/HeritageController.java</url>\r\n          <line>307</line>\r\n          <properties class=\"com.ramiaran.heritagesitesystem.HeritageController\" method=\"searchVisitor\">\r\n            <option name=\"EMULATED\" value=\"true\" />\r\n            <option name=\"WATCH_EXIT\" value=\"false\" />\r\n          </properties>\r\n          <option name=\"timeStamp\" value=\"22\" />\r\n        </line-breakpoint>\r\n      </breakpoints>\r\n    </breakpoint-manager>\r\n  </component>\r\n  <component name=\"XSLT-Support.FileAssociations.UIState\">\r\n    <expand />\r\n    <select />\r\n  </component>\r\n</project>
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/.idea/workspace.xml b/.idea/workspace.xml
--- a/.idea/workspace.xml	(revision 5aab72ecb702ba30513e14379fb1afc33e857df2)
+++ b/.idea/workspace.xml	(date 1767175503358)
@@ -7,7 +7,6 @@
     <list default="true" id="34cabb51-2552-485f-ab94-eb3b3e64f8d7" name="Changes" comment="">
       <change beforePath="$PROJECT_DIR$/.idea/workspace.xml" beforeDir="false" afterPath="$PROJECT_DIR$/.idea/workspace.xml" afterDir="false" />
       <change beforePath="$PROJECT_DIR$/src/main/java/com/ramiaran/heritagesitesystem/HeritageController.java" beforeDir="false" afterPath="$PROJECT_DIR$/src/main/java/com/ramiaran/heritagesitesystem/HeritageController.java" afterDir="false" />
-      <change beforePath="$PROJECT_DIR$/src/main/resources/com/ramiaran/heritagesitesystem/main-view.fxml" beforeDir="false" afterPath="$PROJECT_DIR$/src/main/resources/com/ramiaran/heritagesitesystem/main-view.fxml" afterDir="false" />
     </list>
     <option name="SHOW_DIALOG" value="false" />
     <option name="HIGHLIGHT_CONFLICTS" value="true" />
@@ -129,7 +128,7 @@
       <workItem from="1766860178176" duration="36000" />
       <workItem from="1766860544492" duration="11000" />
       <workItem from="1766866714580" duration="5508000" />
-      <workItem from="1766911376854" duration="30625000" />
+      <workItem from="1766911376854" duration="25741000" />
     </task>
     <servers />
   </component>
@@ -146,31 +145,6 @@
         </entry>
       </map>
     </option>
-  </component>
-  <component name="XDebuggerManager">
-    <breakpoint-manager>
-      <breakpoints>
-        <line-breakpoint enabled="true" type="java-line">
-          <url>file://$PROJECT_DIR$/src/main/java/com/ramiaran/heritagesitesystem/HeritageController.java</url>
-          <line>235</line>
-          <option name="timeStamp" value="6" />
-        </line-breakpoint>
-        <line-breakpoint enabled="true" type="java-line">
-          <url>file://$PROJECT_DIR$/src/main/java/com/ramiaran/heritagesitesystem/HeritageController.java</url>
-          <line>604</line>
-          <option name="timeStamp" value="10" />
-        </line-breakpoint>
-        <line-breakpoint enabled="true" type="java-method">
-          <url>file://$PROJECT_DIR$/src/main/java/com/ramiaran/heritagesitesystem/HeritageController.java</url>
-          <line>307</line>
-          <properties class="com.ramiaran.heritagesitesystem.HeritageController" method="searchVisitor">
-            <option name="EMULATED" value="true" />
-            <option name="WATCH_EXIT" value="false" />
-          </properties>
-          <option name="timeStamp" value="22" />
-        </line-breakpoint>
-      </breakpoints>
-    </breakpoint-manager>
   </component>
   <component name="XSLT-Support.FileAssociations.UIState">
     <expand />
